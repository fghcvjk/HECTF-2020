<code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />error_reporting</span><span style="color: #007700">(</span><span style="color: #0000BB">0</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">highlight_file</span><span style="color: #007700">(</span><span style="color: #0000BB">__FILE__</span><span style="color: #007700">);<br /></span><span style="color: #FF8000">//try&nbsp;flag.php<br /></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">filter</span><span style="color: #007700">(</span><span style="color: #0000BB">$url</span><span style="color: #007700">)&nbsp;{&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$match_result</span><span style="color: #007700">=</span><span style="color: #0000BB">preg_match</span><span style="color: #007700">(</span><span style="color: #DD0000">'/^(http|https)?:\/\/.*(\/)?.*$/'</span><span style="color: #007700">,</span><span style="color: #0000BB">$url</span><span style="color: #007700">);&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!</span><span style="color: #0000BB">$match_result</span><span style="color: #007700">)&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die(</span><span style="color: #DD0000">'url&nbsp;fomat&nbsp;error'</span><span style="color: #007700">);&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$url_parse</span><span style="color: #007700">=</span><span style="color: #0000BB">parse_url</span><span style="color: #007700">(</span><span style="color: #0000BB">$url</span><span style="color: #007700">);&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;catch(</span><span style="color: #0000BB">Exception&nbsp;$e</span><span style="color: #007700">)&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die(</span><span style="color: #DD0000">'url&nbsp;fomat&nbsp;error'</span><span style="color: #007700">);&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$hostname</span><span style="color: #007700">=</span><span style="color: #0000BB">$url_parse</span><span style="color: #007700">[</span><span style="color: #DD0000">'host'</span><span style="color: #007700">];&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$ip</span><span style="color: #007700">=</span><span style="color: #0000BB">gethostbyname</span><span style="color: #007700">(</span><span style="color: #0000BB">$hostname</span><span style="color: #007700">);&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$int_ip</span><span style="color: #007700">=</span><span style="color: #0000BB">ip2long</span><span style="color: #007700">(</span><span style="color: #0000BB">$ip</span><span style="color: #007700">);&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">ip2long</span><span style="color: #007700">(</span><span style="color: #DD0000">'127.0.0.0'</span><span style="color: #007700">)&gt;&gt;</span><span style="color: #0000BB">24&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">$int_ip</span><span style="color: #007700">&gt;&gt;</span><span style="color: #0000BB">24&nbsp;</span><span style="color: #007700">||&nbsp;</span><span style="color: #0000BB">ip2long</span><span style="color: #007700">(</span><span style="color: #DD0000">'10.0.0.0'</span><span style="color: #007700">)&gt;&gt;</span><span style="color: #0000BB">24&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">$int_ip</span><span style="color: #007700">&gt;&gt;</span><span style="color: #0000BB">24&nbsp;</span><span style="color: #007700">||&nbsp;</span><span style="color: #0000BB">ip2long</span><span style="color: #007700">(</span><span style="color: #DD0000">'172.16.0.0'</span><span style="color: #007700">)&gt;&gt;</span><span style="color: #0000BB">20&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">$int_ip</span><span style="color: #007700">&gt;&gt;</span><span style="color: #0000BB">20&nbsp;</span><span style="color: #007700">||&nbsp;</span><span style="color: #0000BB">ip2long</span><span style="color: #007700">(</span><span style="color: #DD0000">'192.168.0.0'</span><span style="color: #007700">)&gt;&gt;</span><span style="color: #0000BB">16&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">$int_ip</span><span style="color: #007700">&gt;&gt;</span><span style="color: #0000BB">16</span><span style="color: #007700">;&nbsp;<br />}&nbsp;<br /></span><span style="color: #0000BB">$url&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">'url'</span><span style="color: #007700">];<br />if(!</span><span style="color: #0000BB">filter</span><span style="color: #007700">(</span><span style="color: #0000BB">$url</span><span style="color: #007700">)){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">file_get_contents</span><span style="color: #007700">(</span><span style="color: #0000BB">$url</span><span style="color: #007700">);<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code>url fomat error